(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))c(e);new MutationObserver(e=>{for(const t of e)if(t.type==="childList")for(const i of t.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&c(i)}).observe(document,{childList:!0,subtree:!0});function n(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?t.credentials="include":e.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function c(e){if(e.ep)return;e.ep=!0;const t=n(e);fetch(e.href,t)}})();function l(o=128){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~";let n="";const c=new Uint8Array(o);crypto.getRandomValues(c);for(let e=0;e<o;e++)n+=r.charAt(c[e]%r.length);return n}async function d(o){const n=new TextEncoder().encode(o),c=await crypto.subtle.digest("SHA-256",n);return btoa(String.fromCharCode(...new Uint8Array(c))).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}function a(){const o=document.getElementById("login"),r=document.getElementById("loggedIn");s?(o.style.display="none",r.style.display="block"):(o.style.display="block",r.style.display="none")}let s=sessionStorage.getItem("access_token")||null;function f(o){console.log("Storing access token:",o),s=o,sessionStorage.setItem("access_token",o)}s&&a();document.getElementById("login").onclick=async()=>{const o=l(),r=await d(o);sessionStorage.setItem("code_verifier",o),console.log("Generated code verifier:",o);const n=new URLSearchParams({response_type:"code",client_id:"97462b80a7864533a23a82791a1f662f",scope:"playlist-read-private playlist-modify-public playlist-modify-private playlist-read-collaborative",redirect_uri:"https://spotify-concat-app.vercel.app/",code_challenge_method:"S256",code_challenge:r});window.location.href=`https://accounts.spotify.com/authorize?${n.toString()}`};async function p(){const r=new URLSearchParams(window.location.search).get("code");if(!r)return;const n=sessionStorage.getItem("code_verifier");if(console.log("Retrieved code verifier:",n),!n){console.error("Code verifier not found in localStorage.");return}const c=new URLSearchParams({client_id:"97462b80a7864533a23a82791a1f662f",grant_type:"authorization_code",code:r,redirect_uri:"https://spotify-concat-app.vercel.app/",code_verifier:n}),t=await(await fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:c})).json();if(console.log("Response from token endpoint:",t),s=t.access_token,!s){console.error("Failed to retrieve access token:",t);return}console.log("Access Token:",t.access_token),f(t.access_token),a()}p();
